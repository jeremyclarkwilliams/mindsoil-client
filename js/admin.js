$(document).ready(function(){});var LoginBox=React.createClass({displayName:"LoginBox",handleLoginSubmit:function e(t){$(".message").text("Logging in..."),$.ajax({url:this.props.url,type:"POST",contentType:"application/x-www-form-urlencoded",data:t,success:function(e){setTimeout(function(){e?window.location=window.location.href+"/panel":$(".message").text("User name or password incorrect.")},2e3)}.bind(this),error:function(e,t,a){console.error(this.props.url,t,a.toString())}.bind(this)})},render:function t(){return React.createElement("div",{className:"container"},React.createElement("h2",{className:"hdr"},"Admin Login"),React.createElement(LoginForm,{onLoginSubmit:this.handleLoginSubmit}))}}),LoginForm=React.createClass({displayName:"LoginForm",getInitialState:function a(){return{user:"",password:""}},handleUserChange:function n(e){this.setState({user:e.target.value})},handlePasswordChange:function s(e){this.setState({password:e.target.value})},handleValidity:function l(e,t){t=t.trim(),t?$("[for=login-"+e+"]").addClass("valid").removeClass("invalid"):$("[for=login-"+e+"]").addClass("invalid").removeClass("valid"),$(".label.valid").length===$(".label").length?$("#btn-login").prop("disabled",!1):$("#btn-login").prop("disabled",!0)},handleSubmit:function i(e){e.preventDefault();var t=this.state.user.trim(),a=this.state.password.trim();this.props.onLoginSubmit({user:t,password:a})},render:function r(){return React.createElement("form",{className:"form",onSubmit:this.handleSubmit,novalidate:!0},React.createElement("label",{htmlFor:"login-user",className:"label"},"User Name"),React.createElement("input",{type:"text",id:"login-user",className:"input",name:"user",value:this.state.user,onChange:this.handleUserChange,onKeyUp:this.handleValidity.bind(this,"user",this.state.user)}),React.createElement("label",{htmlFor:"login-password",className:"label"},"Password"),React.createElement("input",{type:"password",id:"login-password",className:"input",name:"password",value:this.state.password,onChange:this.handlePasswordChange,onKeyUp:this.handleValidity.bind(this,"password",this.state.password)}),React.createElement("input",{type:"submit",name:"submit",id:"btn-login",className:"btn-login",value:"Login",disabled:!0}),React.createElement("p",{className:"message"}))}});null!==document.getElementById("section-admin")&&ReactDOM.render(React.createElement(LoginBox,{url:"admin/login.php"}),document.getElementById("section-admin"));var ClientBox=React.createClass({displayName:"ClientBox",loadClients:function c(){$.ajax({url:"get-clients.php",dataType:"json",cache:!1,success:function(e){this.setState({data:e})}.bind(this),error:function(e,t,a){console.error(this.props.url,t,a.toString())}.bind(this)})},getInitialState:function o(){return{data:[]}},componentDidMount:function d(){this.loadClients(),setInterval(this.loadClients,this.props.pollInterval)},handleAddSubmit:function m(e){var t=this.state.data,a=t.concat([e]);this.setState({data:a}),$.ajax({url:"add-client.php",type:"POST",contentType:"application/x-www-form-urlencoded",data:e,success:function(e){e?$(".message").text("Client credentials added.").delay(3e3).fadeOut():$(".message").text("Something went wrong. Please try again.")}.bind(this),error:function(e,a,n){this.setState({data:t}),console.error(this.props.url,a,n.toString())}.bind(this)})},render:function u(){return React.createElement("div",{className:"container"},React.createElement("h2",{className:"hdr"},"Admin Panel",React.createElement("a",{href:"logout.php",className:"btn-logout"},"Log out")),React.createElement(ClientForm,{onAddSubmit:this.handleAddSubmit}),React.createElement(ClientList,{data:this.state.data}))}}),ClientForm=React.createClass({displayName:"ClientForm",getInitialState:function h(){return{username:"",email:"",password:"",enabled:!1}},handleUserChange:function p(e){this.setState({username:e.target.value})},handleEmailChange:function b(e){this.setState({email:e.target.value})},handlePasswordChange:function g(e){this.setState({password:e.target.value})},handleValidity:function R(e,t,a){var n=/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i;t=t.trim(),!t||"email"===e&&!n.test(t)||a?$("[for=client-"+e+"]").addClass("invalid").removeClass("valid"):$("[for=client-"+e+"]").addClass("valid").removeClass("invalid"),$(".label.valid").length===$(".label").length?$("#btn-add-client").prop("disabled",!1):$("#btn-add-client").prop("disabled",!0)},checkUserName:function f(e){$.ajax({url:"check-user.php",type:"POST",data:{username:e}}).done(function(t){t?this.handleValidity("username",e,!0):this.handleValidity("username",e,!1)}.bind(this))},checkEmail:function E(e){$.ajax({url:"check-email.php",type:"POST",data:{email:e}}).done(function(t){t?this.handleValidity("email",e,!0):this.handleValidity("email",e,!1)}.bind(this))},handleSubmit:function C(e){e.preventDefault();var t=this.state.username.trim(),a=this.state.email.trim(),n=this.state.password.trim();this.props.onAddSubmit({username:t,email:a,password:n}),this.setState({username:"",email:"",password:"",enabled:!1}),$("[for*=client-]").removeClass("valid invalid")},render:function v(){return React.createElement("form",{className:"form",onSubmit:this.handleSubmit,novalidate:!0},React.createElement("h3",{className:"sub-hdr"},"Add Client"),React.createElement("label",{htmlFor:"client-username",className:"label"},"User Name ",React.createElement("i",null,"- must be unique")),React.createElement("input",{type:"text",id:"client-username",className:"input",name:"username",value:this.state.username,onChange:this.handleUserChange,onKeyUp:this.checkUserName.bind(this,this.state.username)}),React.createElement("label",{htmlFor:"client-email",className:"label"},"Email ",React.createElement("i",null,"- must be unique")),React.createElement("input",{type:"email",id:"client-email",className:"input",name:"email",value:this.state.email,onChange:this.handleEmailChange,onKeyUp:this.checkEmail.bind(this,this.state.email)}),React.createElement("label",{htmlFor:"client-password",className:"label"},"Password"),React.createElement("input",{type:"text",id:"client-password",className:"input",name:"password",value:this.state.password,onChange:this.handlePasswordChange,onKeyUp:this.handleValidity.bind(this,"password",this.state.password,!1)}),React.createElement("input",{type:"submit",name:"submit",id:"btn-add-client",className:"btn-primary",value:"Add Client",disabled:!0}),React.createElement("p",{className:"message"}))}}),Client=React.createClass({displayName:"Client",handlePasswordChange:function y(e){27===e.keyCode?this.cancelReset(e):e.target.value.length>0?$(e.target).next().prop("disabled",!1):$(e.target).next().prop("disabled",!0)},handleClick:function w(e,t){$.ajax({url:"enable-client.php",type:"POST",data:{username:e,enabled:t}})},toggleReset:function N(e){$(e.target).closest("td").addClass("inactive").next().removeClass("inactive").find(".input").focus()},handleReset:function S(e){e.persist(),e.preventDefault(),$.ajax({url:"change-password.php",type:"POST",data:$(e.target).serialize(),success:function(t){this.cancelReset(e)}.bind(this)})},cancelReset:function x(e){$(e.target).closest("td").addClass("inactive").prev().removeClass("inactive")},render:function L(){var e=1==this.props.enabled?"row-enabled":"row-disabled",t=1==this.props.enabled?"btn-toggle btn-enabled":"btn-toggle btn-disabled",a=1==this.props.enabled?"Disable":"Enable",n="../client/"+this.props.username;return React.createElement("tr",{className:e},React.createElement("td",null,React.createElement("a",{href:n},this.props.username)),React.createElement("td",null,this.props.email),React.createElement("td",null,React.createElement("button",{className:"btn-reset",onClick:this.toggleReset},"Reset")),React.createElement("td",{className:"inactive"},React.createElement("form",{className:"form",onSubmit:this.handleReset,novalidate:!0},React.createElement("input",{type:"hidden",name:"username",value:this.props.username}),React.createElement("input",{type:"text",className:"input",name:"password",onKeyUp:this.handlePasswordChange}),React.createElement("button",{type:"submit",name:"submit",className:"btn-icon fa fa-arrow-right",disabled:!0}),React.createElement("button",{className:"btn-icon fa fa-times",onClick:this.cancelReset}))),React.createElement("td",null,React.createElement("button",{className:t,onClick:this.handleClick.bind(this,this.props.username,this.props.enabled)},React.createElement("span",{className:"handle"},a))))}}),ClientList=React.createClass({displayName:"ClientList",render:function P(){var e=this.props.data.map(function(e){return React.createElement(Client,{username:e.username,email:e.email,enabled:e.enabled,key:e.id})});return React.createElement("div",{className:"client-container"},React.createElement("h3",{className:"sub-hdr"},"Client List"),React.createElement("table",{className:"client-table"},React.createElement("tbody",null,React.createElement("tr",null,React.createElement("th",null,"User"),React.createElement("th",null,"Email"),React.createElement("th",null,"Password"),React.createElement("th",null,"Toggle")),e)))}});null!==document.getElementById("section-clients")&&ReactDOM.render(React.createElement(ClientBox,{pollInterval:1e3}),document.getElementById("section-clients"));